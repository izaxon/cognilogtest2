import{r as _,j as e}from"./react-CFvbW3tR.js";import{r as I,d as G,m as W,b as U,e as A,B as p,f as c,h as V,s as K,k as Y}from"./codicent-app-sdk-DXRVzLEb.js";import{L as X}from"./react-router-dom-DAwTWwZD.js";import{c as y,d as S,e as B,H as J,I as Q,f as Z}from"./index-DeBjKzBM.js";import{c as ee,s as b}from"./@griffel-B6ADR5Kd.js";import{I as te}from"./@fluentui-hGxI4ynz.js";import"./@braintree-DY5JYOZd.js";import"./@mermaid-js-U5IBypfp.js";import"./langium-CdARkFFN.js";import"./vscode-jsonrpc-ByHGxxVC.js";import"./vscode-languageserver-types-NoPvPymt.js";import"./chevrotain-D1YjmfcG.js";import"./@chevrotain-D6nI8fqk.js";import"./lodash-es-DC2U6FIr.js";import"./chevrotain-allstar-DEMvE_-m.js";import"./vscode-uri-D3CQYEzw.js";import"./vscode-languageserver-textdocument-CKBVUiR3.js";import"./react-router-C-4Ov6ZN.js";import"./@remix-run-Df5FVpDT.js";import"./react-dom-o8OcDbuK.js";import"./mermaid-C_HjE0iy.js";import"./ts-dedent-DrFu-skq.js";import"./d3-transition-Dh49aRff.js";import"./d3-dispatch-kxCwF96_.js";import"./d3-timer-DdKHrDhs.js";import"./d3-interpolate-CfLzPKWk.js";import"./d3-color-amxIadob.js";import"./d3-selection-Bj1BqfTz.js";import"./d3-ease-DRPgKoYJ.js";import"./d3-zoom-BjlmSQgB.js";import"./dompurify-BlFzGd2J.js";import"./stylis-Bmj7FPPA.js";import"./dagre-d3-es-3reODgjt.js";import"./khroma-DUX6PT6k.js";import"./dayjs-B-NUFg1t.js";import"./d3-scale-C6sbQl2n.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-DGRYoJHh.js";import"./d3-format-CzD4bSOQ.js";import"./d3-time-format-DgsO5LpX.js";import"./d3-time-BF7_rz0X.js";import"./d3-axis-DSWTncID.js";import"./d3-shape-L3Itesln.js";import"./d3-path-CimkQT29.js";import"./roughjs-GtHDBO_d.js";import"./cytoscape-BlEmlE64.js";import"./cytoscape-cose-bilkent-NPpav9ZH.js";import"./cose-base-B9X2GT9R.js";import"./layout-base-85SqnYhL.js";import"./d3-sankey-CgO6js3K.js";import"./d3-scale-chromatic-CvOaoHrI.js";import"./@iconify-D2F_yRRF.js";import"./marked-DK8KC6kv.js";import"./cytoscape-fcose-V_63gsaN.js";import"./@auth0-DpSad-xP.js";import"./rtl-css-js-DzRCw-ju.js";import"./@emotion-WldOFDRm.js";import"./react-is-D0tnNtx9.js";import"./keyborg-DWQCxiIY.js";const oe=ee({main:{flexGrow:1,...b.padding("10px"),overflowY:"auto",touchAction:"pan-y"},root:{height:"100%",backgroundPosition:"calc(50%) center",backgroundRepeat:"no-repeat",backgroundSize:"contain",touchAction:"pan-y",pointerEvents:"none"},item:{height:"auto",width:"auto",flexShrink:1},menuButton:{width:"16rem",border:"none","&.selected":{border:"none"},minWidth:"15rem",backgroundColor:void 0,color:void 0,...b.border("none"),"&:hover":{color:void 0,backgroundColor:void 0},"&:active":{color:void 0,backgroundColor:void 0},"&selected":{color:void 0,backgroundColor:void 0},padding:"1.2rem 1rem"},buttonsList:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",flexDirection:"column",alignItems:"center",gap:"1.5rem",...b.padding("10px"),paddingTop:"30px",pointerEvents:"auto"},buttonContent:{display:"flex",alignItems:"center",gap:"8px"},welcomeInfo:{display:"flex",flexDirection:"column",gap:"8px",alignItems:"center",textAlign:"center",maxWidth:"20rem",pointerEvents:"auto"},scrollableContent:{overflowY:"auto"}}),lt=({state:w,audio:P,voice:s})=>{const{selectedApp:r,nickname:E,apps:h,name:re}=w.context,{service:g,error:x,stateMachine:f,currentStateName:a}=w,n=oe(),[,z]=I("app-theme_"+r,null),[T,k]=I("app-buttons_"+r,[]),[l,C]=_.useState(!1),{updating:N,welcomeStatusText:v}=G(f),{t:o}=W();_.useEffect(()=>{if(r)try{const t=y,i=S;if(i&&t.apps[i]){const m=t.apps[i].buttons;m.sort((d,u)=>d.title.localeCompare(u.title)),k(m)}else console.warn(`App buttons configuration not found for: ${i}`),g.getAppButtons().then(k).catch(console.warn)}catch(t){alert("Failed to parse APP_BUTTONS: "+t),console.error(t)}},[g,k,r,z]);const $=async()=>{C(!0);{console.error("APP_NAME not defined."),alert("APP_NAME not defined."),C(!1);return}},L=()=>{window.location.href="./",console.log(`check_request: ${E}, ${r}`)},R=!r||a!=="hasAccess",q=!r||a!=="hasAccess",D=r&&a==="hasAccess",H=!r&&a==="hasAccess"&&h.length>1,M=!x&&!r&&!B,O=a==="noAccess"&&(h.length===1||B),F=r&&a==="hasAccess";return e.jsx(U,{hideHeader:R,hideFooter:q,audio:P,voice:s,children:e.jsxs("div",{className:n.root,style:{backgroundImage:`url(${J})`},children:[e.jsx("div",{className:n.item,children:e.jsx("div",{className:n.item,children:e.jsxs("div",{className:n.buttonsList,children:[H&&e.jsxs(e.Fragment,{children:[e.jsx(A,{children:o("Välkommen, vart vill du gå?")}),h.map((t,i)=>e.jsx("div",{children:e.jsx(p,{size:"large",appearance:"primary",className:n.menuButton,onClick:()=>{f.setSelectedApp(t.id),console.log(`select_app: ${t.id}`)},children:e.jsxs("div",{className:n.buttonContent,children:[t.logo&&e.jsx(te,{src:t.logo,height:24}),t.title||t.id]})})},"codicent_button_"+i))]}),M&&e.jsxs(e.Fragment,{children:[e.jsx(A,{children:o("Skapa ny?")}),e.jsx(c,{size:400,children:o("Här går du vidare för att skapa din egna privata digitala assistent.")}),e.jsx(p,{size:"large",appearance:"primary",className:n.menuButton,onClick:()=>{f.update(),console.log("create_app: requested")},children:o("Kör!")})]}),O&&e.jsx("div",{children:e.jsxs(V,{children:[e.jsx(A,{children:`${o("Välkommen till")} ${Q}`}),!l&&e.jsx(c,{size:400,children:o("Du är inte medlem än. Skicka begäran för att komma in!")}),!l&&e.jsx(p,{size:"large",appearance:"primary",onClick:$,children:o("Skicka begäran")}),!l&&e.jsxs(c,{size:300,children:[o("Har du redan ett abonnemang? Då kanske har du loggat in med fel konto.")," ",e.jsx(X,{to:"/logout",children:o("Logga ut")})," ",o("och sedan in igen för att komma igång.")]}),l&&e.jsx(c,{size:400,children:o("Begäran skickad till ägaren.")}),l&&e.jsx(p,{size:"large",onClick:L,children:o("Kontrollera åtkomst")})]})}),F&&e.jsxs("div",{className:n.welcomeInfo,children:[e.jsx(c,{weight:"semibold",size:500,align:"center",children:o("Välkommen")}),Z,N&&e.jsx(K,{}),!N&&v&&e.jsx(c,{size:400,align:"center",children:v})]}),D&&T.map((t,i)=>e.jsx("div",{children:e.jsx(Y,{service:g,children:m=>e.jsx(p,{size:"large",appearance:"primary",className:n.menuButton,onClick:()=>{if(console.log(t.title),t.url.startsWith("voice:")){const d=t.url.replace("voice:","").trim();if(d!=="")s==null||s.updateInstructions(d);else{const u=y,j=S;u.apps[j]?s==null||s.updateInstructions(u.apps[j].voiceInstructions||""):console.error(`Voice instructions not found for app: ${j}`)}s==null||s.connectConversation()}else m(t.url)},children:o(t.title)})})},"button_"+i))]})})}),x&&e.jsx("div",{className:"error",children:x})]})})};export{lt as Home,lt as default};
