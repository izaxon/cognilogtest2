var v=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function C(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var s={},e={};Object.defineProperty(e,"__esModule",{value:!0});e.BLANK_URL=e.relativeFirstCharacters=e.whitespaceEscapeCharsRegex=e.urlSchemeRegex=e.ctrlCharactersRegex=e.htmlCtrlEntityRegex=e.htmlEntitiesRegex=e.invalidProtocolRegex=void 0;e.invalidProtocolRegex=/^([^\w]*)(javascript|data|vbscript)/im;e.htmlEntitiesRegex=/&#(\w+)(^\w|;)?/g;e.htmlCtrlEntityRegex=/&(newline|tab);/gi;e.ctrlCharactersRegex=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim;e.urlSchemeRegex=/^.+(:|&colon;)/gim;e.whitespaceEscapeCharsRegex=/(\\|%5[cC])((%(6[eE]|72|74))|[nrt])/g;e.relativeFirstCharacters=[".","/"];e.BLANK_URL="about:blank";Object.defineProperty(s,"__esModule",{value:!0});var g=s.sanitizeUrl=void 0,r=e;function m(t){return r.relativeFirstCharacters.indexOf(t[0])>-1}function R(t){var n=t.replace(r.ctrlCharactersRegex,"");return n.replace(r.htmlEntitiesRegex,function(a,i){return String.fromCharCode(i)})}function f(t){return URL.canParse(t)}function d(t){try{return decodeURIComponent(t)}catch{return t}}function p(t){if(!t)return r.BLANK_URL;var n,a=d(t.trim());do a=R(a).replace(r.htmlCtrlEntityRegex,"").replace(r.ctrlCharactersRegex,"").replace(r.whitespaceEscapeCharsRegex,"").trim(),a=d(a),n=a.match(r.ctrlCharactersRegex)||a.match(r.htmlEntitiesRegex)||a.match(r.htmlCtrlEntityRegex)||a.match(r.whitespaceEscapeCharsRegex);while(n&&n.length>0);var i=a;if(!i)return r.BLANK_URL;if(m(i))return i;var h=i.trimStart(),u=h.match(r.urlSchemeRegex);if(!u)return i;var l=u[0].toLowerCase().trim();if(r.invalidProtocolRegex.test(l))return r.BLANK_URL;var c=h.replace(/\\/g,"/");if(l==="mailto:"||l.includes("://"))return c;if(l==="http:"||l==="https:"){if(!f(c))return r.BLANK_URL;var o=new URL(c);return o.protocol=o.protocol.toLowerCase(),o.hostname=o.hostname.toLowerCase(),o.toString()}return c}g=s.sanitizeUrl=p;export{v as c,C as g,g as s};
